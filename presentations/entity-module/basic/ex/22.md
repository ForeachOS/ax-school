### Oefening 22: ViewElementPostProcessor gebruiken

* Ondersteun rich text met behulp van CKEditor op het remarks veld van de BookingFollowup

<!---
* Het is mogelijk om 2 musicals met dezelfde naam aan te maken. 
Custom validator toevoegen die naam gaat zoeken.
* Rich text ondersteuning met CKEditor toevoegen op de musical description, mbv ViewElementPostProcessor.
--->

----

### Tips & Relevante documentatie

* [Property controls](https://across-docs.foreach.be/across-site/production/entity-module/3.2.0/property-controls/index.html)

----

### Oplossing

#### Invoice configuration
```java
entities.withType( Booking.class )
        .formView( "invoice",
                   EntityViewCustomizers.basicSettings()
                                        .adminMenu( "/invoice" )
                                        .andThen(
                                                fvb -> fvb.showProperties( "invoice.*", "followUp" )
                                                          .properties(
                                                                  props -> props.property( "followUp[].remarks" )
                                                                                .viewElementPostProcessor( ViewElementMode.CONTROL, applyWysiwyg() )
                                                          )
                                        )
        );
```

#### Applying wysiwyg config
```java
	private ViewElementPostProcessor<TextboxFormElement> applyWysiwyg() {
		return ( builderContext, element ) -> {
			WebResourceRegistry webResourceRegistry = builderContext.getAttribute( WebResourceRegistry.class );
			webResourceRegistry.add( WebResource.JAVASCRIPT, "https://cdn.ckeditor.com/ckeditor5/11.1.1/classic/ckeditor.js", WebResource.EXTERNAL );
			webResourceRegistry.add( WebResource.JAVASCRIPT_PAGE_END, "/static/booking/js/rich-text.js", WebResource.VIEWS );
			element.setAttribute( "rich-text", true );
		};
	}
```

#### rich-text initialization
```javascript
EntityModule.registerInitializer( function ( node ) {
    $('[rich-text]').each(function(){
       ClassicEditor.create(this);
    });
} );
```